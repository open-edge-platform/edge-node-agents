# SPDX-FileCopyrightText: (C) 2025 Intel Corporation
# SPDX-License-Identifier: Apache-2.0

# Device Discovery Agent - Configuration File
# 
# This file contains configuration for device-discovery-agent.
# This file is loaded via the -config flag in the SystemD service.
# CLI flags will override values specified here.
# Format: KEY=VALUE (one per line)
# Lines starting with # are comments

# ============================================================================
# REQUIRED: Service Endpoints
# ============================================================================

# Onboarding Manager Service Address (hostname or IP)
# CLI flag: -obm-svc
OBM_SVC=localhost

# Onboarding Stream Service Address (hostname or IP)  
# CLI flag: -obs-svc
OBS_SVC=localhost

# Onboarding Manager Service Port
# CLI flag: -obm-port
OBM_PORT=50051

# Keycloak Authentication URL (hostname or IP)
# CLI flag: -keycloak-url
KEYCLOAK_URL=keycloak.example.com

# CA Certificate Path (required for TLS verification)
# CLI flag: -ca-cert
CA_CERT=/etc/intel_edge_node/orch-ca-cert/orch-ca.pem

# ============================================================================
# REQUIRED (unless AUTO_DETECT=true): Device Information
# ============================================================================

# MAC Address of the device's primary network interface
# CLI flag: -mac
# Note: Required unless AUTO_DETECT=true
# MAC=00:11:22:33:44:55

# ============================================================================
# OPTIONAL: Device Information (auto-detected if not provided)
# ============================================================================

# System Serial Number
# CLI flag: -serial
# Note: Auto-detected using dmidecode if not provided
# SERIAL=ABC123

# System UUID
# CLI flag: -uuid
# Note: Auto-detected using dmidecode if not provided
# UUID=12345678-1234-1234-1234-123456789012

# IP Address
# CLI flag: -ip
# Note: Auto-detected from MAC address if not provided
# IP=192.168.1.100

# ============================================================================
# AUTO-DETECTION
# ============================================================================

# Auto-detect all system information (MAC, serial, UUID, IP)
# CLI flag: -auto-detect
# When enabled, all device information will be automatically detected
# Values: true, false
AUTO_DETECT=true

# ============================================================================
# OPTIONAL: Additional Configuration
# ============================================================================

# Additional host-to-IP mappings for /etc/hosts
# CLI flag: -extra-hosts
# Format: host1:ip1,host2:ip2,host3:ip3
# Example: registry.local:10.0.0.1,api.local:10.0.0.2
# EXTRA_HOSTS=registry.local:10.0.0.1,api.local:10.0.0.2

# Enable debug mode with extended logging
# CLI flag: -debug
# Values: true, false
DEBUG=false

# Timeout duration for operations in debug mode
# CLI flag: -timeout
# Format: Duration string (e.g., 5m, 300s, 5m30s)
# Default: 5m
TIMEOUT=5m

# Disable interactive mode fallback
# CLI flag: -disable-interactive
# When true, if non-interactive mode fails, the agent will not fall back to interactive mode
# Values: true, false
DISABLE_INTERACTIVE=false

# ============================================================================
# ADDITIONAL OPTIONS
# ============================================================================

# Use kernel command line arguments for configuration
# CLI flag: -use-kernel-args
# When true, reads configuration from /proc/cmdline
# Values: true, false
USE_KERNEL_ARGS=false

# ============================================================================
# IMPORTANT NOTES
# ============================================================================
# - This file is loaded by the SystemD service via: 
#   ExecStart=/opt/edge-node/bin/device-discovery-agent -config /etc/edge-node/node/confs/device-discovery-agent.env
# - The -config flag ONLY accepts KEY=VALUE format (NOT YAML)
# - During installation, debconf prompts will update values in this file

# ============================================================================
# PRIORITY ORDER (highest to lowest)
# ============================================================================
# 1. CLI flags (highest priority)
# 2. Kernel command line arguments (if -use-kernel-args is passed)
# 3. This configuration file (loaded via -config flag)
# 4. Default values hardcoded in the application

# ============================================================================
# USAGE EXAMPLES
# ============================================================================

# Example 1: Auto-detect all system information
# AUTO_DETECT=true
# OBM_SVC=obm.production.com
# OBS_SVC=obs.production.com
# OBM_PORT=50051
# KEYCLOAK_URL=auth.production.com
# CA_CERT=/etc/ssl/certs/production-ca.pem

# Example 2: Manual configuration with specific MAC
# AUTO_DETECT=false
# MAC=00:1A:2B:3C:4D:5E
# OBM_SVC=obm.staging.com
# OBS_SVC=obs.staging.com
# OBM_PORT=50051
# KEYCLOAK_URL=keycloak.staging.com
# CA_CERT=/etc/ssl/certs/staging-ca.pem

# Example 3: Debug mode with custom timeout
# DEBUG=true
# TIMEOUT=10m
# AUTO_DETECT=true
# OBM_SVC=localhost
# OBS_SVC=localhost
# OBM_PORT=50051
# KEYCLOAK_URL=localhost
# CA_CERT=/tmp/test-ca.pem
